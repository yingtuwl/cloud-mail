import{M as Q,S as Z,C as L,b as Ie,aS as Ve,E as G,d as le,as as ce,z as ne,k as y,F as Me,u as te,bo as Ne,bp as ke,aY as Pe,j as fe,_ as Be,a as ve,bq as Re,c as H,o as k,e as W,f as O,g as a,n as V,r as ee,N as oe,P as xe,ap as ze,m as j,p as ae,h as Le,t as se,a7 as re,br as Fe,q as $e,bb as Ae,O as Oe,ab as Ke,bs as Ue,a_ as qe,L as ie,a6 as He,i as We,w as je}from"./index-DpP8vbvu.js";import{t as ue,a as Ge}from"./el-tag-CjAzCWMf.js";import{I as ge,C as z,U as K}from"./event-BB_Ol6Sd.js";import{d as Xe,a as Ye,b as Je,c as Qe}from"./index-D7KcZu8a.js";import{c as Ze,d as ea,u as aa}from"./vnode-DPqF99Zc.js";import{d as de}from"./index-BMdPKuCq.js";import{c as ta,u as na}from"./el-select-BvsCrs4t.js";const la=Ie({modelValue:{type:le(Array)},max:Number,tagType:{...ue.type,default:"info"},tagEffect:ue.effect,trigger:{type:le(String),default:G.enter},draggable:Boolean,delimiter:{type:[String,RegExp],default:""},size:Ve,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),oa={[K]:e=>Z(e)||L(e),[z]:e=>Z(e)||L(e),[ge]:e=>Q(e),"add-tag":e=>Q(e)||Z(e),"remove-tag":e=>Q(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function sa({props:e,emit:s,formItem:d}){const p=Xe(),T=Ye(),h=ce(),l=ne(),c=y(()=>["small"].includes(T.value)?"small":"default"),C=y(()=>{var t;return(t=e.modelValue)!=null&&t.length?void 0:e.placeholder}),i=y(()=>!(e.readonly||p.value)),f=y(()=>{var t,n;return L(e.max)?!1:((n=(t=e.modelValue)==null?void 0:t.length)!=null?n:0)>=e.max}),r=t=>{var n;const g=[...(n=e.modelValue)!=null?n:[],...ta(t)];s(K,g),s(z,g),s("add-tag",t),l.value=void 0},P=t=>{var n,g;const E=t.split(e.delimiter).filter(S=>S&&S!==t);if(e.max){const S=e.max-((g=(n=e.modelValue)==null?void 0:n.length)!=null?g:0);E.splice(S)}return E.length===1?E[0]:E},w=t=>{if(f.value){l.value=void 0;return}if(!_.value){if(e.delimiter&&l.value){const n=P(l.value);n.length&&r(n)}s(ge,t.target.value)}},v=t=>{var n;if(!_.value)switch(t.code){case e.trigger:t.preventDefault(),t.stopPropagation(),o();break;case G.numpadEnter:e.trigger===G.enter&&(t.preventDefault(),t.stopPropagation(),o());break;case G.backspace:!l.value&&((n=e.modelValue)!=null&&n.length)&&(t.preventDefault(),t.stopPropagation(),m(e.modelValue.length-1));break}},o=()=>{var t;const n=(t=l.value)==null?void 0:t.trim();!n||f.value||r(n)},m=t=>{var n;const g=((n=e.modelValue)!=null?n:[]).slice(),[E]=g.splice(t,1);s(K,g),s(z,g),s("remove-tag",E)},I=()=>{l.value=void 0,s(K,void 0),s(z,void 0),s("clear")},b=(t,n,g)=>{var E;const S=((E=e.modelValue)!=null?E:[]).slice(),[X]=S.splice(t,1),Y=n>t&&g==="before"?-1:n<t&&g==="after"?1:0;S.splice(n+Y,0,X),s(K,S),s(z,S)},D=()=>{var t;(t=h.value)==null||t.focus()},R=()=>{var t;(t=h.value)==null||t.blur()},{wrapperRef:F,isFocused:x}=Ze(h,{disabled:p,afterBlur(){var t;e.saveOnBlur?o():l.value=void 0,e.validateEvent&&((t=d?.validate)==null||t.call(d,"blur").catch(n=>de()))}}),{isComposing:_,handleCompositionStart:M,handleCompositionUpdate:$,handleCompositionEnd:B}=ea({afterComposition:w});return Me(()=>e.modelValue,()=>{var t;e.validateEvent&&((t=d?.validate)==null||t.call(d,z).catch(n=>de()))}),{inputRef:h,wrapperRef:F,isFocused:x,isComposing:_,inputValue:l,size:T,tagSize:c,placeholder:C,closable:i,disabled:p,inputLimit:f,handleDragged:b,handleInput:w,handleKeydown:v,handleAddTag:o,handleRemoveTag:m,handleClear:I,handleCompositionStart:M,handleCompositionUpdate:$,handleCompositionEnd:B,focus:D,blur:R}}function ra(){const e=ne(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function ia({wrapperRef:e,handleDragged:s,afterDragged:d}){const p=te("input-tag"),T=ce(),h=ne(!1);let l,c,C,i;function f(v){return`.${p.e("inner")} .${p.namespace.value}-tag:nth-child(${v+1})`}function r(v,o){l=o,c=e.value.querySelector(f(o)),c&&(c.style.opacity="0.5"),v.dataTransfer.effectAllowed="move"}function P(v,o){if(C=o,v.preventDefault(),v.dataTransfer.dropEffect="move",L(l)||l===o){h.value=!1;return}const m=e.value.querySelector(f(o)).getBoundingClientRect(),I=l+1!==o,b=l-1!==o,D=v.clientX-m.left,R=I?b?.5:1:-1,F=b?I?.5:0:1;D<=m.width*R?i="before":D>m.width*F?i="after":i=void 0;const x=e.value.querySelector(`.${p.e("inner")}`),_=x.getBoundingClientRect(),M=Number.parseFloat(Ne(x,"gap"))/2,$=m.top-_.top;let B=-9999;if(i==="before")B=Math.max(m.left-_.left-M,Math.floor(-M/2));else if(i==="after"){const t=m.right-_.left;B=t+(_.width===t?Math.floor(M/2):M)}ke(T.value,{top:`${$}px`,left:`${B}px`}),h.value=!!i}function w(v){v.preventDefault(),c&&(c.style.opacity=""),i&&!L(l)&&!L(C)&&l!==C&&s(l,C,i),h.value=!1,l=void 0,c=null,C=void 0,i=void 0,d?.()}return{dropIndicatorRef:T,showDropIndicator:h,handleDragStart:r,handleDragOver:P,handleDragEnd:w}}function ua({props:e,isFocused:s,hovering:d,disabled:p,inputValue:T,size:h,validateState:l,validateIcon:c,needStatusIcon:C}){const i=Pe(),f=fe(),r=te("input-tag"),P=te("input"),w=y(()=>[r.b(),r.is("focused",s.value),r.is("hovering",d.value),r.is("disabled",p.value),r.m(h.value),r.e("wrapper"),i.class]),v=y(()=>[i.style]),o=y(()=>{var b,D;return[r.e("inner"),r.is("draggable",e.draggable),r.is("left-space",!((b=e.modelValue)!=null&&b.length)&&!f.prefix),r.is("right-space",!((D=e.modelValue)!=null&&D.length)&&!I.value)]}),m=y(()=>{var b;return e.clearable&&!p.value&&!e.readonly&&(((b=e.modelValue)==null?void 0:b.length)||T.value)&&(s.value||d.value)}),I=y(()=>f.suffix||m.value||l.value&&c.value&&C.value);return{ns:r,nsInput:P,containerKls:w,containerStyle:v,innerKls:o,showClear:m,showSuffix:I}}const da=ve({name:"ElInputTag",inheritAttrs:!1}),ca=ve({...da,props:la,emits:oa,setup(e,{expose:s,emit:d}){const p=e,T=aa(),h=fe(),{form:l,formItem:c}=Je(),{inputId:C}=Qe(p,{formItemContext:c}),i=y(()=>{var u;return(u=l?.statusIcon)!=null?u:!1}),f=y(()=>c?.validateState||""),r=y(()=>f.value&&Re[f.value]),{inputRef:P,wrapperRef:w,isFocused:v,inputValue:o,size:m,tagSize:I,placeholder:b,closable:D,disabled:R,handleDragged:F,handleInput:x,handleKeydown:_,handleRemoveTag:M,handleClear:$,handleCompositionStart:B,handleCompositionUpdate:t,handleCompositionEnd:n,focus:g,blur:E}=sa({props:p,emit:d,formItem:c}),{hovering:S,handleMouseEnter:X,handleMouseLeave:Y}=ra(),{calculatorRef:pe,inputStyle:me}=na(),{dropIndicatorRef:he,showDropIndicator:be,handleDragStart:ye,handleDragOver:Ce,handleDragEnd:Ee}=ia({wrapperRef:w,handleDragged:F,afterDragged:g}),{ns:N,nsInput:J,containerKls:Se,containerStyle:De,innerKls:_e,showClear:Te,showSuffix:we}=ua({props:p,hovering:S,isFocused:v,inputValue:o,disabled:R,size:m,validateState:f,validateIcon:r,needStatusIcon:i});return s({focus:g,blur:E}),(u,va)=>(k(),H("div",{ref_key:"wrapperRef",ref:w,class:V(a(Se)),style:We(a(De)),onMouseenter:a(X),onMouseleave:a(Y)},[a(h).prefix?(k(),H("div",{key:0,class:V(a(N).e("prefix"))},[ee(u.$slots,"prefix")],2)):W("v-if",!0),O("div",{class:V(a(_e))},[(k(!0),H(xe,null,ze(u.modelValue,(U,A)=>(k(),j(a(Ge),{key:A,size:a(I),closable:a(D),type:u.tagType,effect:u.tagEffect,draggable:a(D)&&u.draggable,"disable-transitions":"",onClose:q=>a(M)(A),onDragstart:q=>a(ye)(q,A),onDragover:q=>a(Ce)(q,A),onDragend:a(Ee),onDrop:re(()=>{},["stop"])},{default:ae(()=>[ee(u.$slots,"tag",{value:U,index:A},()=>[Le(se(U),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),O("div",{class:V(a(N).e("input-wrapper"))},[oe(O("input",$e({id:a(C),ref_key:"inputRef",ref:P,"onUpdate:modelValue":U=>Ae(o)?o.value=U:null},a(T),{type:"text",minlength:u.minlength,maxlength:u.maxlength,disabled:a(R),readonly:u.readonly,autocomplete:u.autocomplete,tabindex:u.tabindex,placeholder:a(b),autofocus:u.autofocus,ariaLabel:u.ariaLabel,class:a(N).e("input"),style:a(me),onCompositionstart:a(B),onCompositionupdate:a(t),onCompositionend:a(n),onInput:a(x),onKeydown:a(_)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Fe,a(o)]]),O("span",{ref_key:"calculatorRef",ref:pe,"aria-hidden":"true",class:V(a(N).e("input-calculator")),textContent:se(a(o))},null,10,["textContent"])],2),oe(O("div",{ref_key:"dropIndicatorRef",ref:he,class:V(a(N).e("drop-indicator"))},null,2),[[Oe,a(be)]])],2),a(we)?(k(),H("div",{key:1,class:V(a(N).e("suffix"))},[ee(u.$slots,"suffix"),a(Te)?(k(),j(a(ie),{key:0,class:V([a(N).e("icon"),a(N).e("clear")]),onMousedown:re(a(qe),["prevent"]),onClick:a($)},{default:ae(()=>[Ke(a(Ue))]),_:1},8,["class","onMousedown","onClick"])):W("v-if",!0),a(f)&&a(r)&&a(i)?(k(),j(a(ie),{key:1,class:V([a(J).e("icon"),a(J).e("validateIcon"),a(J).is("loading",a(f)==="validating")])},{default:ae(()=>[(k(),j(He(a(r))))]),_:1},8,["class"])):W("v-if",!0)],2)):W("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var fa=Be(ca,[["__file","input-tag.vue"]]);const Ea=je(fa);export{Ea as E};
